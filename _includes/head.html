<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head lang="en">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>{% if page.title %}{{ page.title }} - {% endif %}{{ site.title }}</title>
  <meta name="author" content="{{ site.author }}">
  <meta name="theme-color" content="{% if page.themecolor %}#{{page.themecolor}}{% else %}000000{% endif%}">

  {% capture description %}{% if page.description %}{{ page.description }}{% else %}{{ content | raw_content }}{% endif %}{% endcapture %}
  <meta name="description" content="{{ description | strip_html | condense_spaces | truncate:150 }}">
  {% if page.keywords %}<meta name="keywords" content="{{ page.keywords }}">{% endif %}

  <meta name="viewport" content="width=device-width, initial-scale=1">
  {% capture canonical %}{{ site.url }}{% if site.permalink contains '.html' %}{{ page.url }}{% else %}{{ page.url | remove:'index.html' }}{% endif %}{% endcapture %}
  <link rel="canonical" href="{{ canonical }}">
  <link href="{{ root_url }}/favicon.png" rel="icon">
  <link href="{{ root_url }}/css/screen.css" rel="stylesheet" type="text/css">
  <link href="{{ site.subscribe_rss }}" rel="alternate" title="{{site.title}}" type="application/atom+xml">
  {% include google_analytics.html %}
  <script>
    // Injection detection framework

 var detectInjection = function(knownHostsArray) {
  var requests = window.performance.getEntriesByType("resource");
  var unknownHosts = [];
  var knownHosts = {};
  var foundHosts = {};

  for (var knownHost in knownHostsArray) {
      knownHosts[knownHostsArray[knownHost]] = true;
  } 
 
  for(var requestIdx = 0; requestIdx < requests.length; requestIdx++) {
    var request = requests[requestIdx];
    var url = new URL(request.name);
    var host = url.host;

    // Aggregate all the requests from a host

    if(host in foundHosts) {
      foundHosts[host].push(request);
    }
    else {
      foundHosts[host] = new Array(request);
    }
  }
  
  for(var foundHost in foundHosts) {
    // If an unknown host is found, add it to a list.
    if(!(foundHost in knownHosts)) {
      unknownHosts.push([foundHost, foundHosts[foundHost]]);
    }
  }
  
  return unknownHosts;
};

window.addEventListener("load", function() {
  var scripts = detectInjection(["paul.kinlan.me", "ssl.google-analytics.com", "www.google-analytics.com", "disqus.com", "paulkinlan.disqus.com"]);
  
  if(!!scripts == true && scripts.length > 0) {
    for(var scriptsIdx = 0; scriptsIdx < scripts.length; scriptsIdx++) {
      var scr = scripts[scriptsIdx][0];
      var reason = scripts[scriptsIdx][1];
      ga('send', 'event', 'load', 'unknown-host', scr, {'nonInteraction': 1});
    }
  }
});

  </script>
</head>
