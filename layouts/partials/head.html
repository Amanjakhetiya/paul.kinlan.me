<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head lang="en">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="dns-prefetch" href="https://fonts.google.com">
  <link rel="dns-prefetch" href="https://fonts.googleapis.com">
  <link rel="dns-prefetch" href="https://fonts.gstatic.com">
  <link rel="dns-prefetch" href="https://www.google-analytics.com">
  <link rel="dns-prefetch" href="https://www.youtube.com">
  <link rel="dns-prefetch" href="https://www.google-analytics.com">
  <link rel="dns-prefetch" href="https://a.disquscdn.com">
  <link rel="dns-prefetch" href="https://paulkinlan.disqus.com">
  <link rel="dns-prefetch" href="https://s.ytimg.com">
  
  <title>{{ if .Title }}{{ .Title }} - {{ end }}{{ .Site.Title }}</title>
  <meta name="author" content="{{ .Site.Params.author }}">
  <meta name="theme-color" content="{{ if .Params.themecolor }}#{{ .Params.themecolor}}{{ else }}000000{{ end }}">
  {{ if .Description }}
  <meta name="description" content="{{ .Description }}">
  {{ end }}
  
  <link href="/favicon.png" rel="icon">
  <link href="/css/material.min.css" rel="stylesheet" type="text/css">
  {{ partial "styles-min.html" . }}
  <link href='https://fonts.googleapis.com/css?family=Roboto:regular,bold,italic,thin,light,bolditalic,black,medium&amp;lang=en' rel='stylesheet' type='text/css'>
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
  <script src="/javascripts/material.min.js" async></script>
  {{ if .RSSlink }}
  <link href="{{ .RSSlink }}" rel="alternate" type="application/rss+xml" title="{{ .Site.Title }}" />
  <link href="{{ .RSSlink }}" rel="feed" type="application/rss+xml" title="{{ .Site.Title }}" />
  {{ end }}
  {{ partial "google_analytics.html" . }}  
  <script>
  navigator.serviceWorker.register('/sw.js')
    .then(function(registration) {
      console.log("Service Worker Registered", registration);
    }, function(e) {
      console.log("Service Worker Failure", e);
    });
    
// embed loadCSS

function loadCSS( href, before, media, callback ){
	"use strict";
	// Arguments explained:
	// `href` is the URL for your CSS file.
	// `before` optionally defines the element we'll use as a reference for injecting our <link>
	// By default, `before` uses the first <script> element in the page.
	// However, since the order in which stylesheets are referenced matters, you might need a more specific location in your document.
	// If so, pass a different reference element to the `before` argument and it'll insert before that instead
	// note: `insertBefore` is used instead of `appendChild`, for safety re: http://www.paulirish.com/2011/surefire-dom-element-insertion/
	var ss = window.document.createElement( "link" );
	var ref = before || window.document.getElementsByTagName( "script" )[ 0 ];
	var sheets = window.document.styleSheets;
	ss.rel = "stylesheet";
	ss.href = href;
	// temporarily, set media to something non-matching to ensure it'll fetch without blocking render
	ss.media = "only x";
	// DEPRECATED
	if( callback ) {
		ss.onload = callback;
	}

	// inject link
	ref.parentNode.insertBefore( ss, ref );
	// This function sets the link's media back to `all` so that the stylesheet applies once it loads
	// It is designed to poll until document.styleSheets includes the new sheet.
	ss.onloadcssdefined = function( cb ){
		var defined;
		for( var i = 0; i < sheets.length; i++ ){
			if( sheets[ i ].href && sheets[ i ].href === ss.href ){
				defined = true;
			}
		}
		if( defined ){
			cb();
		} else {
			setTimeout(function() {
				ss.onloadcssdefined( cb );
			});
		}
	};
	ss.onloadcssdefined(function() {
		ss.media = media || "all";
	});
	return ss;
}

 // Injection detection framework
 var detectInjection = function(knownHostsArray) {
  var requests = window.performance.getEntriesByType("resource");
  var unknownHosts = [];
  var knownHosts = {};
  var foundHosts = {};

  for (var knownHost in knownHostsArray) {
      knownHosts[knownHostsArray[knownHost]] = true;
  } 
 
  for(var requestIdx = 0; requestIdx < requests.length; requestIdx++) {
    var request = requests[requestIdx];
    var url = new URL(request.name);
    var host = url.host;

    // Aggregate all the requests from a host

    if(host in foundHosts) {
      foundHosts[host].push(request);
    }
    else {
      foundHosts[host] = new Array(request);
    }
  }
  
  for(var foundHost in foundHosts) {
    // If an unknown host is found, add it to a list.
    if(!(foundHost in knownHosts)) {
      unknownHosts.push([foundHost, foundHosts[foundHost]]);
    }
  }
  
  return unknownHosts;
};

window.addEventListener("load", function() {
  var scripts = detectInjection(["paul.kinlan.me", "ssl.google-analytics.com", "www.google-analytics.com", "disqus.com", "paulkinlan.disqus.com"]);
  
  if(!!scripts == true && scripts.length > 0) {
    for(var scriptsIdx = 0; scriptsIdx < scripts.length; scriptsIdx++) {
      var scr = scripts[scriptsIdx][0];
      var reason = scripts[scriptsIdx][1];
      ga('send', 'event', 'load', 'unknown-host', scr, {'nonInteraction': 1});
    }
  }
});
  </script>
</head>