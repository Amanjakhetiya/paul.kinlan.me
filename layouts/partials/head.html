<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="iem7"><![endif]-->
<!--[if lt IE 9]><html class="lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html lang="en"><!--<![endif]-->
<head lang="en">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="dns-prefetch" href="https://www.youtube.com">
  <link rel="dns-prefetch" href="https://www.google-analytics.com">
  <link rel="dns-prefetch" href="https://a.disquscdn.com">
  <link rel="dns-prefetch" href="https://paulkinlan.disqus.com">
  <link rel="dns-prefetch" href="https://s.ytimg.com">
  <meta http-equiv="Accept-CH" content="DPR, Viewport-Width, Width">
  
  <title>{{ if .Title }}{{ .Title }} - {{ end }}{{ .Site.Title }}</title>
  <meta name="author" content="{{ .Site.Params.author }}">
  <meta name="theme-color" content="{{ if .Params.themecolor }}#{{ .Params.themecolor}}{{ else }}000000{{ end }}">
  {{if .Params.image_header}}
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:image" content="{{.Params.image_header}}">
  {{else}}
  <meta name="twitter:card" content="summary">
  {{end}}
  <meta name="twitter:site" content="@paul_kinlan">
  <meta name="twitter:creator" content="@paul_kinlan">
  {{ if .Title }}
  <meta name="twitter:title" content="{{ .Title }} ">
  {{end}}
  {{ if .Description }}
  <meta name="description" content="{{ .Description }}">
  <meta name="twitter:description" content="{{ .Description }}">
  {{ end }}
  <link href="/images/me.png" rel="icon">
  <link href="/manifest.json" rel="manifest">
  {{ partial "styles-min.html" . }}
  {{ partial "criticalcss.html" . }}
  <link href='https://fonts.googleapis.com/css?family=Roboto:regular,bold,italic,thin,light,bolditalic,black,medium&amp;lang=en' rel='stylesheet' type='text/css'>
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
  <link href="/index.xml" rel="alternate" type="application/rss+xml" title="{{ .Site.Title }}" />
  <link href="/index.xml" rel="feed" type="application/rss+xml" title="{{ .Site.Title }}" />
  {{ partial "google_analytics.html" . }}  
  
  <script>
  navigator.serviceWorker.register('/sw.js')
    .then(function(registration) { console.log("Service Worker Registered", registration); }, 
          function(e) { console.log("Service Worker Failure", e); });
 // Injection detection framework
 var detectInjection = function(knownHostsArray) {
  var requests = window.performance.getEntriesByType("resource");
  var unknownHosts = [];
  var knownHosts = {};
  var foundHosts = {};

  for (var knownHost in knownHostsArray) {
      knownHosts[knownHostsArray[knownHost]] = true;
  } 
 
  for(var requestIdx = 0; requestIdx < requests.length; requestIdx++) {
    var request = requests[requestIdx];
    var url = new URL(request.name);
    var host = url.host;

    // Aggregate all the requests from a host

    if(host in foundHosts) {
      foundHosts[host].push(request);
    }
    else {
      foundHosts[host] = new Array(request);
    }
  }
  
  for(var foundHost in foundHosts) {
    // If an unknown host is found, add it to a list.
    if(!(foundHost in knownHosts)) {
      unknownHosts.push([foundHost, foundHosts[foundHost]]);
    }
  }
  
  return unknownHosts;
};

window.addEventListener("load", function() {
  var scripts = detectInjection(["paul.kinlan.me", "ssl.google-analytics.com", "www.google-analytics.com", "disqus.com", "paulkinlan.disqus.com"]);
  
  if(!!scripts == true && scripts.length > 0) {
    for(var scriptsIdx = 0; scriptsIdx < scripts.length; scriptsIdx++) {
      var scr = scripts[scriptsIdx][0];
      var reason = scripts[scriptsIdx][1];
      ga('send', 'event', 'load', 'unknown-host', scr, {'nonInteraction': 1});
    }
  }
});
  </script>
</head>
