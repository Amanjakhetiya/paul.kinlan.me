{{ partial "head.html" . }}

<body class="blogpost">
  <div>
    <header class="" style="{{ if .Params.image_header }}background-image: url('{{ .Params.image_header}}');{{ end }}">
      <h3>{{ .Title }}</h3>
    </header>
    <div class="menu">
     <a href="/">Home</a>
    </div>
    <main class="">
        <div id="content" >
          <div class="author">
            <div class="minilogo"></div>
            <div>
              <strong>Paul Kinlan</strong>
              <span><time pubdate>{{  .Date.Format "January 2 2006" }}</time></span>
            </div>
          </div>
          {{ if isset .Params "podcast_url" }}
          <audio controls class="podcast">
            <a href="{{ .Params.podcast_url }}">Download this podcast</a>
	          <source src="{{ .Params.podcast_url }}">
          </audio>
          {{ end }}
          {{ .Content }}
          {{ partial "share.html" . }}
          <div class="comments" id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'paulkinlan'; // required: replace example with your forum shortname
    /* * * DON'T EDIT BELOW THIS LINE * * */
    window.addEventListener("load", function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    });
</script>
{{ if and (isset .Params "podcast_url") }}
<script src="https://cdn.jsdelivr.net/webtorrent/latest/webtorrent.min.js"></script>
<script type="text/javascript">
var torrentUrl = '{{ .Site.BaseURL }}{{ .Params.podcast_url }}.torrent';
var onPodcastTorrent = function(torrent) {
  console.log('torrent added', torrent)
  torrent.on('done', function() {
    console.log('torrent done')
    torrent.files[0].renderTo('audio.podcast');
  });
};

var client = new WebTorrent();
client.on('torrent', onPodcastTorrent);
client.add(torrentUrl);
</script>
{{ end }}
<script type="text/javascript">
  window.addEventListener("load", function() {
    var iframes = document.getElementsByTagName("iframe");
    for(var i = 0; i < iframes.length; i++) {
      var ifr = iframes[i];
      if(ifr.hasAttribute("data-src")) {
        var src = ifr.getAttribute("data-src");
        ifr.setAttribute("src", src);
      }
    }
  });
</script>
        </div>
        
        <footer role="contentinfo">{{ partial "footer.html" . }}</footer>
        <nav class="">
          
        </nav>
    </main>
  </div>
  
</body>
</html>